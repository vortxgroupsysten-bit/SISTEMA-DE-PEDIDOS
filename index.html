<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gar칞om App</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* --- RESET & VARIAVEIS --- */
        :root {
            --bg: #0f111a;
            --surface: #1f242e;
            --primary: #ff9f43; /* Laranja (A칞칚o) */
            --success: #2ecc71; /* Verde (Confirmar) */
            --danger: #e74c3c;
            --text: #ffffff;
            --text-sub: #a0a0a0;
            --border: #2d3342;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; margin: 0; padding: 0; }
        
        body { 
            font-family: 'Inter', sans-serif; 
            background: var(--bg); 
            color: var(--text); 
            height: 100vh; 
            display: flex; 
            flex-direction: column; 
            overflow: hidden; /* Impede scroll na pagina inteira, apenas no conteudo */
        }

        /* --- HEADER FIXO --- */
        .app-header {
            background: rgba(31, 36, 46, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px;
            border-bottom: 1px solid var(--border);
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .input-row { display: flex; gap: 10px; margin-bottom: 12px; }

        input {
            background: #161b22;
            border: 1px solid var(--border);
            color: white;
            padding: 12px;
            border-radius: 8px;
            font-size: 16px; /* Tamanho 16px evita zoom automatico no iPhone */
            font-weight: 500;
        }
        input:focus { border-color: var(--primary); }
        
        #input-waiter { flex: 2; } /* Nome ocupa mais espa칞o */
        #input-table { flex: 1; text-align: center; }

        /* Tabs de Categoria (Estilo Bot칚o Grande) */
        .tabs { display: flex; background: #161b22; padding: 4px; border-radius: 10px; }
        .tab-btn {
            flex: 1;
            padding: 10px;
            border: none;
            background: transparent;
            color: var(--text-sub);
            font-weight: 600;
            font-size: 0.9rem;
            border-radius: 8px;
            transition: 0.2s;
        }
        .tab-btn.active {
            background: var(--surface);
            color: var(--primary);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        /* --- CONTE칔DO SCROLL츼VEL --- */
        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            padding-bottom: 160px; /* Espa칞o extra para n칚o esconder itens atr치s da barra de baixo */
            -webkit-overflow-scrolling: touch; /* Scroll suave no iOS */
        }

        /* --- LISTA DE PRODUTOS (LAYOUT MELHORADO) --- */
        .product-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--surface);
            padding: 16px;
            margin-bottom: 12px;
            border-radius: 12px;
            border: 1px solid var(--border);
            transition: transform 0.1s;
            position: relative;
            overflow: hidden;
        }

        /* Efeito ao clicar */
        .product-item:active { transform: scale(0.98); background: #252b36; }

        .prod-info h3 { font-size: 1rem; font-weight: 600; margin-bottom: 4px; }
        .prod-info .price { color: var(--primary); font-weight: 700; font-size: 1.1rem; }
        
        .btn-add-icon {
            background: var(--primary);
            color: #1a1a1a;
            width: 40px; 
            height: 40px;
            border-radius: 50%;
            display: flex; 
            align-items: center; 
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(255, 159, 67, 0.3);
        }

        /* --- BARRA FLUTUANTE DE PEDIDO (Total + Enviar) --- */
        .order-bar {
            position: fixed;
            bottom: 70px; /* Acima da navbar */
            left: 15px;
            right: 15px;
            background: #252b36;
            border: 1px solid var(--success);
            padding: 12px 20px;
            border-radius: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transform: translateY(150%);
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 50;
        }
        .order-bar.visible { transform: translateY(0); }

        .total-info span { font-size: 0.8rem; color: var(--text-sub); text-transform: uppercase; letter-spacing: 1px; }
        .total-info div { font-size: 1.4rem; font-weight: 800; color: var(--success); }

        .btn-send {
            background: var(--success);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1rem;
            display: flex; align-items: center; gap: 8px;
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }
        .btn-send:active { transform: scale(0.95); }

        /* --- NAVBAR INFERIOR (Troca de Telas) --- */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            width: 100%;
            height: 60px;
            background: #161b22;
            border-top: 1px solid var(--border);
            display: flex;
            z-index: 60;
            padding-bottom: env(safe-area-inset-bottom); /* Respeita o bot칚o home do iPhone */
        }
        .nav-item {
            flex: 1;
            background: none;
            border: none;
            color: #555;
            font-size: 0.75rem;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            gap: 4px;
        }
        .nav-item.active { color: var(--primary); }
        .nav-item svg { width: 24px; height: 24px; fill: currentColor; }

        /* --- TOAST (Notifica칞칚o) --- */
        .toast {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            background: #333; color: #fff; padding: 12px 20px; border-radius: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.5); z-index: 100;
            font-weight: 600; font-size: 0.9rem; opacity: 0; transition: 0.3s;
            pointer-events: none; white-space: nowrap; border: 1px solid #555;
        }
        .toast.show { opacity: 1; top: 30px; }

        /* Utilit치rios */
        .hidden { display: none !important; }

        /* Estilo para lista de mesas (Aba 2) */
        .table-card {
            background: var(--surface); padding: 15px; margin-bottom: 10px; border-radius: 10px;
            border-left: 4px solid var(--success); display: flex; justify-content: space-between; align-items: center;
        }
    </style>
</head>
<body>

    <div id="toast" class="toast">Mensagem aqui</div>

    <section id="screen-order" class="content-area">
        <div style="height: 140px;"></div> </section>

    <div id="header-order" class="app-header" style="position:fixed; top:0; width:100%;">
        <div class="input-row">
            <input type="text" id="waiter-name" placeholder="Seu Nome" spellcheck="false">
            <input type="tel" id="table-num" placeholder="Mesa" maxlength="3"> 
        </div>
        <div class="tabs">
            <button class="tab-btn active" onclick="App.filter('food', this)">COMIDA</button>
            <button class="tab-btn" onclick="App.filter('drink', this)">BEBIDA</button>
        </div>
    </div>

    <section id="screen-bills" class="content-area hidden" style="padding-top: 80px;">
        <h2 style="margin-bottom: 15px; font-size:1.2rem;">Mesas Ativas</h2>
        <input type="text" placeholder="游댍 Filtrar mesa..." style="width:100%; margin-bottom:15px;" onkeyup="App.renderTables(this.value)">
        <div id="tables-list"></div>
    </section>

    <div id="order-bar" class="order-bar">
        <div class="total-info">
            <span>Total</span>
            <div id="cart-total">R$ 0,00</div>
        </div>
        <button class="btn-send" onclick="App.sendOrder()">
            ENVIAR <span style="font-size:1.2rem">游</span>
        </button>
    </div>

    <nav class="bottom-nav">
        <button class="nav-item active" onclick="App.nav('order', this)">
            <svg viewBox="0 0 24 24"><path d="M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2v7zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4z"/></svg>
            Novo Pedido
        </button>
        <button class="nav-item" onclick="App.nav('bills', this)">
            <svg viewBox="0 0 24 24"><path d="M14 10H2v2h12v-2zm0-4H2v2h12V6zm4 8v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zM2 16h8v-2H2v2z"/></svg>
            Mesas
        </button>
    </nav>

    <script>
        const DB = {
            products: [
                { id: 1, name: "X-Burger", price: 25.00, type: "food" },
                { id: 2, name: "Batata Frita", price: 15.00, type: "food" },
                { id: 3, name: "Pizza Fatia", price: 12.00, type: "food" },
                { id: 4, name: "Pastel Carne", price: 8.00, type: "food" },
                { id: 5, name: "Coca-Cola", price: 6.00, type: "drink" },
                { id: 6, name: "Suco Natural", price: 8.00, type: "drink" },
                { id: 7, name: "Cerveja Lata", price: 10.00, type: "drink" },
                { id: 8, name: "츼gua 500ml", price: 4.00, type: "drink" }
            ],
            cart: [],
            get: (k) => JSON.parse(localStorage.getItem(k)) || [],
            set: (k,v) => localStorage.setItem(k, JSON.stringify(v))
        };

        const App = {
            init: () => {
                // Recupera nome do gar칞om
                const savedName = localStorage.getItem('waiterName');
                if(savedName) document.getElementById('waiter-name').value = savedName;

                App.renderProducts('food');
                setInterval(App.checkNotifs, 3000);
            },

            // --- RENDERIZA칂츾O ---
            renderProducts: (type) => {
                const container = document.getElementById('screen-order');
                // Limpa apenas os itens, mantendo o espa칞ador do topo
                container.innerHTML = '<div style="height: 140px;"></div>'; 
                
                DB.products.filter(p => p.type === type).forEach(p => {
                    // Criando elemento DOM para adicionar evento de clique melhor
                    const el = document.createElement('div');
                    el.className = 'product-item';
                    el.onclick = () => App.add(p.id, el); // Passa o elemento para anima칞칚o
                    el.innerHTML = `
                        <div class="prod-info">
                            <h3>${p.name}</h3>
                            <div class="price">R$ ${p.price.toFixed(2)}</div>
                        </div>
                        <div class="btn-add-icon">+</div>
                    `;
                    container.appendChild(el);
                });
            },

            renderTables: (filter = '') => {
                const tabs = JSON.parse(localStorage.getItem('restaurantTabs')) || {};
                const list = document.getElementById('tables-list');
                const keys = Object.keys(tabs);
                list.innerHTML = '';

                if(keys.length === 0) list.innerHTML = '<div style="text-align:center; color:#777; margin-top:30px;">Sem mesas ativas</div>';

                keys.forEach(t => {
                    if(filter && !t.includes(filter)) return;
                    const total = tabs[t].reduce((acc, i) => acc + (i.price * i.qty), 0);
                    
                    list.innerHTML += `
                        <div class="table-card">
                            <div>
                                <strong>Mesa ${t}</strong>
                                <div style="color:#aaa">R$ ${total.toFixed(2)}</div>
                            </div>
                            <button class="btn-send" style="padding:8px 16px; font-size:0.8rem;" onclick="App.payTable('${t}')">Fechar</button>
                        </div>
                    `;
                });
            },

            // --- A칂칏ES ---
            filter: (type, btn) => {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                App.renderProducts(type);
            },

            add: (id, element) => {
                const item = DB.products.find(p => p.id === id);
                DB.cart.push(item);
                App.updateTotal();

                // Feedback Visual e T치til
                element.style.transform = "scale(0.97)";
                element.style.background = "#252b36";
                setTimeout(() => {
                    element.style.transform = "scale(1)";
                    element.style.background = "";
                }, 100);

                // Vibra칞칚o (Android)
                if(navigator.vibrate) navigator.vibrate(30); 
            },

            updateTotal: () => {
                const total = DB.cart.reduce((acc, i) => acc + i.price, 0);
                document.getElementById('cart-total').innerText = `R$ ${total.toFixed(2)}`;
                
                const bar = document.getElementById('order-bar');
                if(DB.cart.length > 0) bar.classList.add('visible');
                else bar.classList.remove('visible');
            },

            sendOrder: () => {
                const waiter = document.getElementById('waiter-name').value;
                const table = document.getElementById('table-num').value;

                if(!waiter || !table) return App.toast("丘멆잺 Nome e Mesa obrigat칩rios!");

                // Salva nome
                localStorage.setItem('waiterName', waiter);

                // Agrupa itens
                const grouped = [];
                DB.cart.forEach(item => {
                    const exist = grouped.find(i => i.id === item.id);
                    exist ? exist.qty++ : grouped.push({...item, qty:1});
                });

                const order = {
                    id: Date.now(),
                    table, waiter,
                    items: grouped,
                    time: new Date().toLocaleTimeString('pt-BR', {hour:'2-digit', minute:'2-digit'})
                };

                const orders = DB.get('restaurantOrders');
                orders.push(order);
                DB.set('restaurantOrders', orders);

                DB.cart = [];
                App.updateTotal();
                document.getElementById('table-num').value = ''; // Limpa mesa, mantem gar칞om
                App.toast("Pedido Enviado! 游");
            },

            payTable: (t) => {
                if(!confirm('Fechar conta da Mesa ' + t + '?')) return;
                
                const tabs = JSON.parse(localStorage.getItem('restaurantTabs'));
                const items = tabs[t];
                
                // Hist칩rico
                const history = DB.get('restaurantSalesHistory');
                items.forEach(i => history.push({
                    waiter: i.waiter || 'App',
                    amount: i.price * i.qty,
                    item: i.name,
                    time: new Date().toLocaleTimeString()
                }));
                DB.set('restaurantSalesHistory', history);

                // Delete
                delete tabs[t];
                localStorage.setItem('restaurantTabs', JSON.stringify(tabs));
                App.renderTables();
                App.toast("Conta Fechada!");
            },

            // --- UTILIDADES ---
            nav: (view, btn) => {
                document.querySelectorAll('.content-area').forEach(el => el.classList.add('hidden'));
                document.getElementById('screen-' + view).classList.remove('hidden');
                
                document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
                btn.classList.add('active');

                // L칩gica especifica de cada tela
                if(view === 'bills') {
                    App.renderTables();
                    document.getElementById('header-order').style.display = 'none';
                } else {
                    document.getElementById('header-order').style.display = 'block';
                }
            },

            toast: (msg) => {
                const t = document.getElementById('toast');
                t.innerHTML = msg;
                t.classList.add('show');
                setTimeout(() => t.classList.remove('show'), 3000);
            },

            checkNotifs: () => {
                const notifs = DB.get('restaurantNotifications');
                if(notifs.length > 0) {
                    notifs.forEach(n => App.toast(`游댒 ${n.msg}`));
                    DB.set('restaurantNotifications', []);
                    if(navigator.vibrate) navigator.vibrate([100, 50, 100]);
                }
            }
        };

        window.onload = App.init;
    </script>
</body>
</html>
